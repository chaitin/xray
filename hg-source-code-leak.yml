name: poc-yaml-hg-source-code-leak
rules:
  - method: GET
    path: /.hg/
    follow_redirects: false
    expression: >
      response.status == 200 && response.body.bcontains(b'dirstate') && response.body.bcontains(b'requires') && response.body.bcontains(b'store')
detail:
  author: j4ckzh0u(https://github.com/j4ckzh0u)
  Affected Version: "common"
  links:
    - https://zhuanlan.zhihu.com/p/21296806
    - https://github.com/kost/dvcs-ripper
