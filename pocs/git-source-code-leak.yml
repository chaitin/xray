name: poc-yaml-git-source-code-leak
rules:
  - method: GET
    path: /.git/
    follow_redirects: false
    expression: >
      response.status == 200 && response.body.bcontains(b'HEAD') && response.body.bcontains(b'index') && response.body.bcontains(b'config')
detail:
  author: j4ckzh0u(https://github.com/j4ckzh0u)
  Affected Version: "common"
  links:
    - https://zhuanlan.zhihu.com/p/21296806
    - https://github.com/lijiejie/GitHack
