name: poc-yaml-amf-deserialization-coldfusion
set:
  rand: randomInt(200000000, 210000000)
rules:
  - method: POST
    path: /flex2gateway/amf
    headers:
      Content-Type: application/x-amf
    body: usernmame={{rand}}
    follow_redirects: false
    expression: |
        response.body.bcontains(b"Unsupported AMF")
detail:
  author: zusheng(https://isbase.cc/)
  links:
    - https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html
    - https://www.exploit-db.com/exploits/43993
    - https://github.com/codewhitesec/ColdFusionPwn
