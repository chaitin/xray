name: poc-yaml-thinkcmf-templete-cache-writeshell
set:
  tem_name: randomLowercase(10)
rules:
  - method: GET
    path: /index.php?a=display&templateFile={{tem_name}}
    expression: |
      response.status == 404 && response.body.bcontains(bytes('ThinkCMF')) && response.body.bcontains(bytes('themes/simplebootx/Portal/Index/'+tem_name+'.html'))

detail:
  author: jweny
  ThinkCMF: x1.6.0/x2.1.0/x2.2.0-3
  links:
    - https://mp.weixin.qq.com/s/3d7YrTq0vFSKXV6u0Hjnnw
