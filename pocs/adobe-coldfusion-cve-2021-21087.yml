name: poc-yaml-adobe-coldfusion-cve-2021-21087
groups:
  r1:
    - method: GET
      path: /CFIDE/scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
  r2:
    - method: GET
      path: /cf_scripts/scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
  r3:
    - method: GET
      path: /cfide/scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
  r4:
    - method: GET
      path: /CF_SFSD/scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
  r5:
    - method: GET
      path: /cfide-scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
  r6:
    - method: GET
      path: /cfmx/CFIDE/scripts/ajax/package/cfajax.js
      follow_redirects: false
      expression: |
        response.status == 200 && response.body.bcontains(b"eval(\"(\"+json+\")\")")
detail:
  author: White(https://github.com/WhiteHSBG)
  links:
    - https://nosec.org/home/detail/4707.html
    - https://github.com/projectdiscovery/nuclei-templates/pull/1128/files
    - https://helpx.adobe.com/security/products/coldfusion/apsb21-16.html