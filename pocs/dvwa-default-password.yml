name: poc-yaml-dvwa-default-password
rules:
  - method: GET
    path: "/login.php"
    expression: |
      response.status == 200 && response.body.bcontains(b"Login :: Damn Vulnerable Web Applica")
    search: |
      <input type='hidden' name='user_token' value='(?P<user_token>.+?)' />
  - method: POST
    path: "/login.php"
    follow_redirects: true
    body: |
      username=admin&password=password&Login=Login&user_token={{user_token}}
    expression: |
      response.status == 200 && response.body.bcontains(b"Logout") && response.body.bcontains(b"Welcome :: Damn Vulnerab")
detail:
  author: tangshoupu
  info: dvwa-default-password [admin:password ]
  links:
    - https://github.com/digininja/DVWA
